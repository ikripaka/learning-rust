use num_traits::Num;
use rust_bigint::BigUint;

fn main() {
    let (a, b, c, pow, module) = (
        "CED0F6B3027C4C0ED408A03EDC3011F72B9813BC664230CC5A831DA31C2D7E22B83E7E7DF3631A8CD55C3BCF00EC9EEDBAD11F0B2BA8854E7C7EFD2FE7FD0EAAF9F1B13297A99D396562777A0AEAEE7CAA0A3EFC4A1BB7685647FC25FBCB6D3D8B1EE4788248F0714932168D2BF19A3D0E078BCFF0AF4F64A14032AA67931823",
        "9181DBCE994DAC85566FCA0CC60F56A5ABC1CA498862554B8BA6448769B94E2EC6A4A0032FC86892127406B8C3FCAE74A945FF3C92EBC41E927E2A595B72A53B57210CCD85102DFA79BD8457D1BD3CE37ADDAF1D383141F53F2E7897AED3D5A3525C9BB40B6EBD611F676881337D757885009E635253F5B80FFB79140C913A3E",
        "3d4f1ae4692e9f897d98d6321620bb517fd64972dddfdb80cedcd91bb2742ff3f199de7ac39ab1fac2e835163ceff079118b1fce98bcc12fea00d2d68c8a696fa2d0a46512996f3eeba4f322392db1992f2c8fdf11ea75731719838e4cf7979a38c248c476da331029caae0bf87424c48906ed6c9e5b59ac9144b9965b01dde5",
        "FF04451a316bb7bfb43b68d5ac7a8898c8decbe0bb620b9c7f93cb1373d6460c23ac0f55918dd9240219116d66133882",
        "FF04451a316bb7bfb43b68d5ac7a8898c8decbe0bb620b9c7f93cb1373d6460c23ac0f55918dd9240219116d661338825fb124997c697e0d9c76c3506a1277e2d1c651d90ac0b66cc209e092bfb598fe1b2e6487cf89ceff779bc94c78883e89dbfbd9f34dffb786b88e664ec9b930937444d64923c252f2a151670729ef8f08c6bcfc9767a2f6e64ac196b0e420b365163b4f4f4221490c491c777847a4cfa94607e67f07e1d73f6762f46ca78e6942d1025373c8d64ab9e616750dd88e47e013fcafc58dd81f145ab992b335d44ebd05596553fbb7f665e18c88879dff4a4c500d48d652d6ee6599a25e1964962546ceebe81929400995571739e7fb75c8c92f75f69b11293d18c8e10a8971226596a821199190762d80e0c27d203a8ccc4b33327adbae1bdcf9e575b8292dd5e234d55dcfd8a6c30ce9bd757df208ccbc2bdbe8086900fa8155099ed21b1040dc081d8b83af48bd6f4c84a393ddaf608ac03b45c4a3f441d30d5b12b4ab74ad83b858a6ce459f50a4cbef55ab607bcf007e437b5dd0acdf3dd77c3d2a7f259e6a4bece4931ff4640c77c0c1cc654cb1238676dcd6f2d41c5c3abfb142cb3ceec4a62752ba64c4298cf93b276994f429187247b6fa0033d04d6e0668b4b7a02faddd1c768ba64634c7133de58494a4d15881b218a0f9c89");

    let (a, b, c, pow, module) = (
        biguint_from_hex(a),
        biguint_from_hex(b),
        biguint_from_hex(c),
        biguint_from_hex(pow),
        biguint_from_hex(module),
    );
    assert_eq!((((a+b)*c.pow_mod(&pow, &module)) % &module).to_lower_hex_string(),
               "ebfad7757714598b2ec2d26f1b7651f5fdcb822383548fa9602faa87e25fe7b1fdd9f96e1365941526afa8431f4243327b80752b3da6918d35f5bd63380f90fdd5de7e870ea7d78983f7a42d52f6000c76f8da050a55140d872052b5b707cfe913a859b0ffc5fc2ba22dd9c75406c427066f77e60e2a2c9e1107736dedbc0e15188877e54829f84ef04c7317158abd4cc57d0012112dd19036e9b0446397f320b9161999dbde89807425cdc1f26f955b8955045ae9f57758e29b70ba6e876a646cba0682448034449702bf3d61b4a4d5fd95a9b9dc3344a5d8fff4c0f10224a0f88897ff0ccafd5615ebca05852d67bcfbdd104466c11aaac815081e2fc1cbed83b5fdcb20492b3bfd48e121500ac5fb89ad5fee69191bf6ba25a96208d53871a24ba2569ead4ad85be00e9f75c4bfc9eaca347a638d05c3701b1b81d9d8b04cec27f7eb7d0a325d84ea10978eaf3712b76c4d2014b2f21dff3f13c589095b13f91abf19aca74d3eaa361c9736a576e0507a9d6fe015c021b14185f00dd17ce166abb17f4b87039e7fb6e8689d36a926abe596d0282b77fc136a38e4f0c0e4aeb5d5b67187cd9418c1bceebb592a8e43c43d118e0a8ae668f8dd608a0e6119c08b7300027c273d368611bc2a3672a760c9cbacbbeb00d16eb68d5f22df2271646f168f9b96b")
}
// 16052d2819bc9f8942a786a4ba23f689cd759de05eea48617e629622a85e6cc517ee31e81232b831ee7d04287c4e94d6264171e47be94496d0efd2789436fb3e65112be001cb9cb33df1ffbd1dca82b6024e7ee19824cf95d957674bdaa9f42e0dd7b802c8db7add268997f0e5f6f0fb593082a334303451cb13babbe74245261
//  857a89660379993ab7488af52ad016548c2aadaaa201e7509551878ee96a160222373920c309a031d869cb98ad977ced509e8c53484d95ead50d376cd840c68e40484a459efcdbcdbb1aaaafb15c6fd32422d174056b2c5a61c7787f9b8f4f230ef09508f85c40d4b0f69a1f8a289a6377a4141d1865c50c88283fe935fa29583a69249a7453a35ba35dcd6e184abd5f35785bb72cc0cb01a22a8bf3be39d5e7aeb167b5764fec8b4b3d4bf56dc25c1c952f03512f2e21c1044e13a5436dec1ab80db06ef32d09740962820da62155a3a77c95884b7f2fc2be2f8ed6b6109e9b6872c823299d3b2225d45467ea789bb35077e9792088bb1a73b42aa4d3f3fe5151c3b9915928420d2f0847ce29b20f9ce46227840c1bf7b17226bec846681739f52307f8a40f3f13f3837da3cd614988a840717c3dae46f4d1102369150fcbe4d28c5b6db08cb08a113a2f00188a9402b0269cd19e86e09f3038011b152a35fed09193cf06912eed39a0349370fdbc11271d5b24f102f63227667eafc12847a770cf460bba5e772c1798db3cb009f612e65201e192ba6396ec32bd4617bd190e870fe7dbc100517c6778fa5df0320a521d1f3588c55ac4fad0ee34f1bb518f385a1b3122433e9c17e24855395aae12ca995d80321e76d31a5b555af0564ef67d894c981fd4a
// ebfad7757714598b2ec2d26f1b7651f5fdcb822383548fa9602faa87e25fe7b1fdd9f96e1365941526afa8431f4243327b80752b3da6918d35f5bd63380f90fdd5de7e870ea7d78983f7a42d52f6000c76f8da050a55140d872052b5b707cfe913a859b0ffc5fc2ba22dd9c75406c427066f77e60e2a2c9e1107736dedbc0e15188877e54829f84ef04c7317158abd4cc57d0012112dd19036e9b0446397f320b9161999dbde89807425cdc1f26f955b8955045ae9f57758e29b70ba6e876a646cba0682448034449702bf3d61b4a4d5fd95a9b9dc3344a5d8fff4c0f10224a0f88897ff0ccafd5615ebca05852d67bcfbdd104466c11aaac815081e2fc1cbed83b5fdcb20492b3bfd48e121500ac5fb89ad5fee69191bf6ba25a96208d53871a24ba2569ead4ad85be00e9f75c4bfc9eaca347a638d05c3701b1b81d9d8b04cec27f7eb7d0a325d84ea10978eaf3712b76c4d2014b2f21dff3f13c589095b13f91abf19aca74d3eaa361c9736a576e0507a9d6fe015c021b14185f00dd17ce166abb17f4b87039e7fb6e8689d36a926abe596d0282b77fc136a38e4f0c0e4aeb5d5b67187cd9418c1bceebb592a8e43c43d118e0a8ae668f8dd608a0e6119c08b7300027c273d368611bc2a3672a760c9cbacbbeb00d16eb68d5f22df2271646f168f9b96b
fn biguint_from_hex(x: &str) -> BigUint {
    BigUint::from_str_radix(x, 16).unwrap()
}
